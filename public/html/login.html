<!DOCTYPE html>   <ï¼DOCTYPE html   è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€ >
<html   è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€ lang="zh-CN">
  <head>   < >è´Ÿè´£äºº
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ç™»å½• - ä¸´æ—¶é‚®ç®±</title>   Login - Temporary Email
    <style>.precheck-hide body{ visibility: hidden; }</style>.precheck-hide body{ visibility: hidden; } è¯¥æ ·å¼ä»£ç å°†éšè—æ•´ä¸ªé¡µé¢å†…å®¹ï¼Œä½¿é¡µé¢ä¸å¯è§ã€‚
    <script>   < >è„šæœ¬
      // ç«‹å³æ£€æŸ¥ç™»å½•çŠ¶æ€ï¼ˆåœ¨ä»»ä½•å…¶ä»–è„šæœ¬ä¹‹å‰ï¼‰
      (function   å‡½æ•°(){
        try{   å°è¯•{
          var hasToken = document.cookie.split(';').some(function   å‡½æ•°(c){ 
            return   è¿”å› c.trim().indexOf('iding-session=') === 0; 
          });
          
          // å¦‚æœæœ‰cookieä½†æ˜¯ä»å…¶ä»–é¡µé¢è·³è½¬è¿‡æ¥çš„ï¼Œå…ˆéªŒè¯æœ‰æ•ˆæ€§å†è·³è½¬
          // é¿å…æ— æ•ˆcookieå¯¼è‡´çš„å¾ªç¯è·³è½¬å’Œé¡µé¢é—ªç°
          if   å¦‚æœ (hasToken && document.referrer) {
            // å¼‚æ­¥éªŒè¯ï¼Œä¸é˜»æ­¢é¡µé¢æ¸²æŸ“
            (async function   å‡½æ•°(){
              try{   å°è¯•{
                const controller = new   æ–° AbortController();
                const tid = setTimeout(function   å‡½æ•°(){ try{ controller.abort(); }catch(_){ } }, 1500);
                const r = await fetch('/api/session', { 
                  method: 'GET', 
                  headers: { 'Cache-Control': 'no-cache' },
                  credentials: 'include',
                  signal: controller.signal
                });
                clearTimeout(tid);
                if   å¦‚æœ (r && r.ok){
                  location.replace('/');
                } else   å…¶ä»– {
                  // cookieæ— æ•ˆï¼Œæ¸…é™¤å®ƒ
                  document.cookie = 'iding-session=ï¼› è¿‡æœŸæ—¶é—´=1970 å¹´ 1 æœˆ 1 æ—¥ 00:00:00 UTCï¼› è·¯å¾„=/document.cookie = 'iding-session   ä¼šè¯=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';
                }
              }catch(_){ 
                // éªŒè¯å¤±è´¥ï¼Œä¿æŒåœ¨ç™»å½•é¡µé¢
              }
            })();
            return;
          } else if (hasToken && !document.referrer) {
            // ç›´æ¥è®¿é—®ç™»å½•é¡µä¸”æœ‰cookieï¼Œç«‹å³é‡å®šå‘
            location.replace('/');
            return;
          }
          
          // æ²¡æœ‰cookieï¼Œåšä¸€æ¬¡ç½‘ç»œæ£€æŸ¥ï¼ˆå¯èƒ½cookieåˆšè®¾ç½®è¿˜æ²¡ç”Ÿæ•ˆï¼‰
          fetch('/api/session', { 
            method: 'GET', 
            headers: { 'Cache-Control': 'no-cache' },
            credentials: 'include'
          }).then(function(r){
            if (r && r.ok){
              location.replace('/');
            }
          }).catch(function(){ 
            // ä¼šè¯æ£€æŸ¥å¤±è´¥ï¼Œä¿æŒåœ¨ç™»å½•é¡µé¢
          });
        }catch(_){ 
          // é”™è¯¯å¤„ç†ï¼Œä¿æŒåœ¨ç™»å½•é¡µé¢
        }
      })();
    </script>
    <script src="/js/auth-guard.js"></script>
    <script>   < >è„šæœ¬
      // å·²ç™»å½•è®¿é—®ç™»å½•é¡µæ—¶ç›´æ¥å›é¦–é¡µï¼›ç™»å‡ºåœºæ™¯è·³è¿‡æ£€æŸ¥
      (function(){   (å‡½æ•°(){
        try{ document.documentElement.classList.add('precheck-hide'); }catch(_){ }
        try{   å°è¯•{
          var u = new URL(location.href);
          var fromLogout = (u.searchParams.get('from') === 'logout') || (sessionStorage.getItem('mf:just_logged_out') === '1');
          if (fromLogout){
            sessionStorage.removeItem('mf:just_logged_out');
            document.documentElement.classList.remove('precheck-hide');
            return;
          }
        }catch(_){ }
        // Cookieæ£€æŸ¥å·²åœ¨é¡µé¢é¡¶éƒ¨æ‰§è¡Œï¼Œè¿™é‡Œè·³è¿‡é‡å¤æ£€æŸ¥
        // 2) ç½‘ç»œå…œåº•ï¼Œå»¶é•¿è¶…æ—¶æ—¶é—´å‡å°‘è¯¯åˆ¤
        try{   å°è¯•{
          var controller = new AbortController();
          var tid = setTimeout(function(){ try{ controller.abort(); }catch(_){ } }, 1500); // ä»500mså»¶é•¿åˆ°1500ms
          fetch('/api/session', { 
            headers: { 'Cache-Control': 'no-cache' }, 
            signal: controller.signal,
            credentials: 'include'
          })
            .then(function(r){
              clearTimeout(tid);
              if (r && r.ok){ location.replace('/'); return; }
              document.documentElement.classList.remove('precheck-hide');
            })
            .catch(function(){ try{ document.documentElement.classList.remove('precheck-hide'); }catch(_){ } });
        }catch(_){ try{ document.documentElement.classList.remove('precheck-hide'); }catch(_){ } }
        // æœ€é•¿ 2s å…œåº•æ˜¾ç¤ºï¼ˆä»1så»¶é•¿åˆ°2sï¼‰
        setTimeout(function(){ try{ document.documentElement.classList.remove('precheck-hide'); }catch(_){ } }, 2000);
      })();
    </script>
    
    <script src="/js/mock.js"></script>
    <link rel="icon" href="favicon.svg" type="image/svg+xml" />
    <link rel="shortcut icon" href="favicon.svg" type="image/svg+xml" />
    <link rel="stylesheet" href="/css/login.css" />
  </head>
  <body>
    <div class="bg"></div>
    <div class="center">
      <div class="card">
        <div class="logo">ğŸ”</div>
        <h1>ç™»å½•åˆ°ä¸´æ—¶é‚®ç®±</h1>
        <div id="err" class="err"></div>
        <input id="username" class="input" type="text" placeholder="ç”¨æˆ·å/é‚®ç®±" />
        <input id="pwd" class="input" type="password" placeholder="å¯†ç " />
        <div style="font-size:12px;color:#64748b;margin-bottom:8px">
          æ¬¢è¿ä½¿ç”¨Goblin_MoMoä¸´æ—¶é‚®ç®±ç³»ç»Ÿã€‚
        </div>
        <button id="login" class="btn">ç™»å½•</button>
      </div>
    </div>
    <div id="toast" class="toast"></div>
    <script src="/js/toast-utils.js"></script>
    <script src="/js/login.js"></script>
  </body>
  </html>

